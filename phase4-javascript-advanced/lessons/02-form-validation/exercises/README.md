# Lesson 2: フォーム操作とバリデーション - 演習問題 📝

このレッスンで学んだ内容を実践して、理解を深めよう！

**難易度**：
- 🟢 **基礎編**（問題 1-3）：フォームの基本操作とバリデーション
- 🟡 **応用編**（問題 4-6）：リアルタイムバリデーションと動的フィールド
- 🔴 **チャレンジ編**（問題 7）：総合的なフォーム実装

**所要時間**：約 2-3 時間

---

## 🟢 基礎編

### 問題 1: 簡単なお問い合わせフォーム

**目標**：フォームのデータを取得して表示する

#### 仕様

以下の項目を持つお問い合わせフォームを作成してください：

1. **フィールド**：
   - 名前（テキスト）
   - メールアドレス（email タイプ）
   - お問い合わせ内容（textarea）

2. **機能**：
   - 「送信」ボタンをクリックすると、入力された内容をコンソールに表示
   - 同時に、フォームの下に入力内容を表示
   - FormData API を使ってデータを取得

3. **注意点**：
   - ページがリロードされないように `preventDefault()` を使う
   - デフォルトの送信動作を防ぐ

#### ヒント

```javascript
// FormDataの使い方
const formData = new FormData(form);
const name = formData.get("name");
```

---

### 問題 2: HTML5 バリデーション属性を使ったフォーム

**目標**：HTML5 の組み込みバリデーション機能を理解する

#### 仕様

ユーザー登録フォームを作成してください：

1. **フィールド**：
   - ユーザー名（3文字以上、20文字以下、必須）
   - メールアドレス（email 形式、必須）
   - パスワード（8文字以上、必須）
   - 年齢（18歳以上、必須）

2. **実装方法**：
   - HTML5 のバリデーション属性を使用（`required`, `minlength`, `maxlength`, `min`, `type` など）
   - JavaScript は最小限（送信時にコンソール出力するだけ）

3. **CSS**：
   - `:valid` と `:invalid` 擬似クラスを使って、入力状態を視覚化
   - 有効な入力：緑の枠線
   - 無効な入力：赤の枠線

#### ヒント

```html
<input type="text" required minlength="3" maxlength="20" />
```

```css
input:valid {
  border-color: #51cf66;
}
input:invalid {
  border-color: #ff6b6b;
}
```

---

### 問題 3: エラーメッセージの表示

**目標**：具体的なエラーメッセージを表示する

#### 仕様

ログインフォームを作成し、エラーメッセージを表示してください：

1. **フィールド**：
   - メールアドレス
   - パスワード

2. **バリデーション**：
   - メールアドレスが空の場合：「メールアドレスを入力してください」
   - メールアドレスの形式が不正な場合：「有効なメールアドレスを入力してください」
   - パスワードが空の場合：「パスワードを入力してください」
   - パスワードが8文字未満の場合：「パスワードは8文字以上で入力してください」

3. **表示方法**：
   - 各フィールドの下に、赤いエラーメッセージを表示
   - 送信ボタンをクリックした時にバリデーション実行
   - エラーがある場合、送信を中止

#### ヒント

```javascript
// 簡易的なメール形式チェック
const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
if (!emailPattern.test(email)) {
  // エラー表示
}
```

---

## 🟡 応用編

### 問題 4: リアルタイムバリデーション

**目標**：入力中にリアルタイムでバリデーションを行う

#### 仕様

ユーザー登録フォームにリアルタイムバリデーションを実装してください：

1. **フィールド**：
   - ユーザー名（3文字以上）
   - メールアドレス
   - パスワード（8文字以上）

2. **リアルタイムバリデーション**：
   - `input` イベントまたは `blur` イベントを使用
   - 入力中または入力完了後に即座にチェック
   - エラーがあれば赤い枠線とエラーメッセージ
   - 正常であれば緑の枠線と「✓ OK!」を表示

3. **送信時のバリデーション**：
   - 全てのフィールドが valid でなければ送信しない
   - エラーがある場合、アラートで通知

#### ヒント

```javascript
input.addEventListener("input", function () {
  // リアルタイムでチェック
  if (input.value.length < 3) {
    input.classList.add("invalid");
    // エラーメッセージ表示
  }
});
```

---

### 問題 5: 正規表現を使ったカスタムバリデーション

**目標**：正規表現を使って複雑なパターンをチェックする

#### 仕様

以下のフィールドを持つフォームを作成し、カスタムバリデーションを実装してください：

1. **フィールドと検証ルール**：
   - **ユーザー名**：英数字とアンダースコアのみ（`/^[a-zA-Z0-9_]+$/`）
   - **電話番号**：`090-1234-5678` の形式（`/^[0-9]{3}-[0-9]{4}-[0-9]{4}$/`）
   - **郵便番号**：`123-4567` の形式（`/^[0-9]{3}-[0-9]{4}$/`）
   - **パスワード**：
     - 8文字以上
     - 大文字を1文字以上含む
     - 小文字を1文字以上含む
     - 数字を1文字以上含む

2. **表示**：
   - リアルタイムでバリデーション
   - エラーメッセージに「どの条件を満たしていないか」を具体的に表示

3. **パスワードの強度表示**（ボーナス）：
   - 条件を満たしている項目をチェックマークで表示

#### ヒント

```javascript
// パスワードの各条件をチェック
const hasUppercase = /[A-Z]/.test(password);
const hasLowercase = /[a-z]/.test(password);
const hasNumber = /[0-9]/.test(password);
```

---

### 問題 6: 動的にフィールドを追加・削除

**目標**：ユーザーの操作でフォームフィールドを動的に追加・削除する

#### 仕様

「スキル登録フォーム」を作成してください：

1. **初期状態**：
   - スキル名の入力フィールドが1つ表示されている
   - 「スキルを追加」ボタン

2. **追加機能**：
   - 「スキルを追加」ボタンをクリックすると、新しい入力フィールドが追加される
   - 追加されたフィールドには「削除」ボタンが表示される
   - 最大5個まで追加可能
   - 5個に達したら「スキルを追加」ボタンを無効化

3. **削除機能**：
   - 「削除」ボタンで、そのフィールドを削除
   - 最初のフィールドは削除できない
   - フィールドが5個未満になったら「スキルを追加」ボタンを有効化

4. **送信処理**：
   - 送信時に、全てのスキルを配列として取得
   - コンソールに表示

#### バイブコーダー向けのヒント 🤖

以下のような指示を AI に出すと良いコードが生成されます：

```
スキルを複数登録できるフォームを作ってください。

【機能】
- 初期状態で1つの入力フィールドを表示
- 「スキルを追加」ボタンで新しいフィールドを動的に追加（最大5個）
- 各フィールドに「削除」ボタンを表示（最初のフィールドは削除不可）
- 送信時に全てのスキルを配列として取得

【技術要件】
- document.createElement() で新しい要素を作成
- appendChild() でDOMに追加
- removeChild() で削除
- input要素のname属性を "skills[]" にして、FormData.getAll() で配列取得

【デザイン】
- 追加ボタンは緑色、削除ボタンは赤色
- 各フィールドをボーダーで囲む
- ボタンにホバー効果を追加
```

#### ヒント

```javascript
// 新しいフィールドを作成
const newField = document.createElement("div");
newField.innerHTML = `
  <input type="text" name="skills[]" />
  <button type="button" class="remove-btn">削除</button>
`;
container.appendChild(newField);

// 送信時に配列として取得
const formData = new FormData(form);
const skills = formData.getAll("skills[]");
console.log(skills); // → ["JavaScript", "HTML", "CSS"]
```

---

## 🔴 チャレンジ編

### 問題 7: 総合課題 - 完全なユーザー登録フォーム

**目標**：これまで学んだ全ての技術を組み合わせて、実用的なフォームを作成する

#### 仕様

プロフェッショナルなユーザー登録フォームを作成してください：

1. **フィールド**：
   - ユーザー名（3-20文字、英数字とアンダースコアのみ、必須）
   - メールアドレス（email 形式、必須）
   - パスワード（8文字以上、大文字・小文字・数字を含む、必須）
   - パスワード確認（パスワードと一致、必須）
   - 生年月日（date タイプ）
   - 性別（ラジオボタン：男性、女性、その他）
   - 趣味（チェックボックス：読書、映画、スポーツ、音楽、ゲーム、旅行）
   - 自己紹介（textarea、最大500文字）

2. **バリデーション機能**：
   - リアルタイムバリデーション（`blur` イベントと `input` イベントの適切な使い分け）
   - パスワード強度の視覚化（プログレスバー + 要件リスト）
   - パスワード確認の一致チェック
   - 具体的なエラーメッセージの表示

3. **デザイン要件**：
   - モダンでプロフェッショナルなデザイン
   - レスポンシブ対応
   - エラー時：赤い枠線 + エラーメッセージ
   - 正常時：緑の枠線 + 成功メッセージ
   - ローディング状態の表示（送信ボタンをクリック後、「処理中...」）

4. **送信処理**：
   - 全てのフィールドをバリデーション
   - エラーがある場合、エラーサマリーを表示（全てのエラーをリスト形式で表示）
   - エラーがない場合：
     - ボタンを「処理中...」に変更して無効化
     - 2秒後に「登録成功！」とアラート表示
     - フォームをリセット
   - コンソールに全てのフォームデータをオブジェクト形式で出力

5. **追加機能（ボーナス）**：
   - 「パスワードを表示」チェックボックス（チェックすると password → text に変更）
   - 入力内容を localStorage に保存（ページをリロードしても復元）
   - リアルタイム文字数カウント（自己紹介欄）

#### 求められるスキル

この課題では、以下の技術を総合的に使います：

- ✅ FormData API の使用
- ✅ HTML5 バリデーション属性
- ✅ JavaScript によるカスタムバリデーション
- ✅ リアルタイムバリデーション（input/blur イベント）
- ✅ 正規表現を使ったパターンマッチング
- ✅ DOM 操作（クラスの追加・削除、要素の表示・非表示）
- ✅ イベント処理（preventDefault、イベントリスナー）
- ✅ CSS による視覚的フィードバック
- ✅ フォーム送信の制御

#### 完成イメージ

```
┌─────────────────────────────────────┐
│  ユーザー登録フォーム                │
├─────────────────────────────────────┤
│                                     │
│  ユーザー名 *                        │
│  [___________________] ✓ OK!        │
│                                     │
│  メールアドレス *                    │
│  [___________________] ✓ OK!        │
│                                     │
│  パスワード *                        │
│  [___________________]              │
│  [████████░░░░░░] 普通              │
│  ✓ 8文字以上                        │
│  ✓ 大文字を含む                      │
│  ✓ 小文字を含む                      │
│  ✗ 数字を含む                        │
│                                     │
│  パスワード確認 *                    │
│  [___________________] ✓ 一致        │
│                                     │
│  性別                                │
│  ○ 男性  ○ 女性  ○ その他           │
│                                     │
│  趣味（複数選択可）                  │
│  ☑ 読書  ☑ 映画  ☐ スポーツ         │
│  ☐ 音楽  ☑ ゲーム  ☐ 旅行           │
│                                     │
│  自己紹介 (0/500)                   │
│  [_____________________________]    │
│  [_____________________________]    │
│                                     │
│         [ 登録する ]                │
└─────────────────────────────────────┘
```

#### ヒント

**段階的に実装しよう**：
1. まず HTML で全てのフィールドを作成
2. CSS でスタイリング
3. 各フィールドのバリデーション関数を作成
4. リアルタイムバリデーションを実装
5. 送信処理を実装
6. エラーサマリーを追加
7. 最後にボーナス機能を追加

**コードの構造化**：
```javascript
// バリデーション関数を個別に作成
function validateUsername(username) { /* ... */ }
function validateEmail(email) { /* ... */ }
function validatePassword(password) { /* ... */ }

// エラー表示用の汎用関数
function showError(fieldId, message) { /* ... */ }
function clearError(fieldId) { /* ... */ }

// フォーム送信時の処理
form.addEventListener("submit", function(event) {
  event.preventDefault();

  // 全フィールドをバリデーション
  const errors = [];

  if (!validateUsername(username.value)) {
    errors.push("ユーザー名が不正です");
  }

  // ... 他のフィールドもチェック ...

  if (errors.length > 0) {
    showErrorSummary(errors);
  } else {
    submitForm();
  }
});
```

---

## 解答例について 📖

全ての演習問題の解答例と詳しい解説は、以下のページで確認できます：

👉 [解答例と解説](./solutions/README.md)

**まずは自分で考えて実装してみよう！** 分からなくなったら、レッスンを見返したり、AI に質問したりしながら進めてね。

完成したら、解答例と比較して、より良いコードの書き方を学ぼう！ 💪

---

## 学習のポイント 🎯

### 躓きやすいポイント

1. **event.preventDefault() を忘れる**
   - フォーム送信時、ページがリロードされてしまう
   - 必ず `event.preventDefault()` を最初に書こう

2. **name 属性を設定し忘れる**
   - FormData で値が取得できない
   - id だけでなく、name 属性も必要

3. **動的に追加した要素にイベントが効かない**
   - 要素を追加する時に、同時にイベントリスナーも設定する
   - または、イベント委譲を使う

4. **正規表現の書き方が分からない**
   - AI に聞いてみよう！「電話番号の形式をチェックする正規表現を教えて」
   - MDN のドキュメントも参考になる

### バイブコーダーのための Tips 🤖

演習問題を AI と一緒に解く場合：

**良いアプローチ**：
1. まず自分で仕様を理解する
2. HTML の構造だけ先に書いてみる
3. 分からない部分を具体的に AI に質問
4. AI の回答を理解してから実装
5. 動作確認して、問題があれば修正

**避けるべきアプローチ**：
1. 問題文をそのまま AI にコピペ
2. 生成されたコードをそのまま使う
3. コードを理解せずに提出

**AI への質問例**：
- 「パスワードの強度をチェックする関数を書いてください。8文字以上、大文字・小文字・数字を含むことを条件にしてください」
- 「FormData で取得した値をコンソールに出力する方法を教えてください」
- 「動的に追加した削除ボタンにイベントリスナーを設定する方法は？」

**理解を深めるために**：
- 生成されたコードに、自分でコメントを追加してみる
- 変数名や関数名を変更して、動作を確認
- 一部を削除して、何が起こるか確認

---

## 完成したら 🎉

全ての演習を完了したら：

1. ✅ 各問題の動作を確認
2. ✅ コンソールにエラーが出ていないかチェック
3. ✅ コードに適切なコメントを追加
4. ✅ 解答例と比較して、改善点を見つける

**おめでとう！** これでフォーム操作とバリデーションの基礎が身についたよ！

次のレッスンでは、**非同期処理と API 通信**を学んで、さらに高度な機能を実装していこう！ 🚀
