<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å•é¡Œ 3-5: async/await ã¸ã®å¤‰æ›</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
      }

      .container {
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 900px;
        width: 100%;
      }

      h1 {
        color: #333;
        margin-bottom: 10px;
        font-size: 28px;
        text-align: center;
      }

      .subtitle {
        color: #666;
        margin-bottom: 30px;
        font-size: 14px;
        text-align: center;
      }

      .comparison {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin: 30px 0;
      }

      .method-card {
        background: #f8f9fa;
        border-radius: 15px;
        padding: 20px;
        border: 2px solid #e9ecef;
      }

      .method-card.active {
        border-color: #4facfe;
        box-shadow: 0 5px 15px rgba(79, 172, 254, 0.3);
      }

      .method-title {
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 15px;
        text-align: center;
        color: #333;
      }

      .method-card.promise .method-title {
        color: #667eea;
      }

      .method-card.async .method-title {
        color: #4facfe;
      }

      .code-display {
        background: #2d3748;
        color: #f7fafc;
        padding: 15px;
        border-radius: 10px;
        font-family: "Courier New", monospace;
        font-size: 12px;
        line-height: 1.8;
        overflow-x: auto;
        margin-bottom: 15px;
      }

      .code-display .keyword {
        color: #f093fb;
      }

      .code-display .function {
        color: #38ef7d;
      }

      .code-display .string {
        color: #ffd93d;
      }

      .code-display .comment {
        color: #718096;
      }

      .execute-button {
        width: 100%;
        padding: 12px;
        font-size: 14px;
        font-weight: bold;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s;
      }

      .method-card.promise .execute-button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .method-card.async .execute-button {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
      }

      .execute-button:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .execute-button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none !important;
      }

      .progress-bar {
        height: 8px;
        background: #e9ecef;
        border-radius: 4px;
        margin: 15px 0;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, #4facfe, #00f2fe);
        transition: width 0.3s;
      }

      .log-box {
        background: #2d3748;
        color: #f7fafc;
        padding: 20px;
        border-radius: 10px;
        margin-top: 20px;
        max-height: 250px;
        overflow-y: auto;
        font-family: "Courier New", monospace;
        font-size: 13px;
      }

      .log-entry {
        margin-bottom: 8px;
        line-height: 1.6;
      }

      .log-entry.success {
        color: #38ef7d;
      }

      .log-entry.info {
        color: #4facfe;
      }

      .log-entry.complete {
        color: #ffd93d;
      }

      .control-buttons {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin-top: 20px;
      }

      .reset-button {
        padding: 12px 30px;
        font-size: 14px;
        font-weight: bold;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        background: #6c757d;
        color: white;
        transition: all 0.3s;
      }

      .reset-button:hover {
        background: #5a6268;
        transform: translateY(-2px);
      }

      .info-box {
        background: #f8f9fa;
        border-left: 4px solid #4facfe;
        padding: 15px;
        margin-top: 30px;
        text-align: left;
        border-radius: 5px;
      }

      .info-box h3 {
        color: #4facfe;
        margin-bottom: 10px;
        font-size: 16px;
      }

      .info-box ul {
        margin-left: 20px;
        color: #666;
        font-size: 14px;
        line-height: 1.8;
      }

      .advantages {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-top: 20px;
      }

      .advantage-card {
        background: linear-gradient(135deg, #e0f7ff 0%, #d0f0ff 100%);
        padding: 15px;
        border-radius: 10px;
        border-left: 4px solid #4facfe;
      }

      .advantage-card h4 {
        color: #4facfe;
        margin-bottom: 8px;
        font-size: 14px;
      }

      .advantage-card p {
        color: #666;
        font-size: 13px;
        line-height: 1.6;
      }

      @media (max-width: 768px) {
        .comparison {
          grid-template-columns: 1fr;
        }

        .advantages {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸš€ async/await ã¸ã®å¤‰æ›</h1>
      <p class="subtitle">å•é¡Œ 3-5: å¿œç”¨ç·¨</p>

      <div class="comparison">
        <!-- Promise ãƒã‚§ãƒ¼ãƒ³ -->
        <div class="method-card promise">
          <div class="method-title">âš™ï¸ Promise ãƒã‚§ãƒ¼ãƒ³</div>
          <div class="code-display">
            <span class="keyword">function</span>
            <span class="function">makePizza</span>() {<br />
            &nbsp;&nbsp;buyIngredients()<br />
            &nbsp;&nbsp;&nbsp;&nbsp;.<span class="function">then</span>(i =>
            cutIngredients(i))<br />
            &nbsp;&nbsp;&nbsp;&nbsp;.<span class="function">then</span>(p =>
            cook(p))<br />
            &nbsp;&nbsp;&nbsp;&nbsp;.<span class="function">then</span>(f =>
            serve(f))<br />
            &nbsp;&nbsp;&nbsp;&nbsp;.<span class="function">then</span>(m =>
            log(m))<br />
            &nbsp;&nbsp;&nbsp;&nbsp;.<span class="function">catch</span>(e =>
            error(e));<br />
            }
          </div>
          <button class="execute-button" id="promiseButton">
            Promise ã§å®Ÿè¡Œ
          </button>
          <div class="progress-bar">
            <div class="progress-fill" id="promiseProgress"></div>
          </div>
        </div>

        <!-- async/await -->
        <div class="method-card async active">
          <div class="method-title">âœ¨ async/awaitï¼ˆæ¨å¥¨ï¼‰</div>
          <div class="code-display">
            <span class="keyword">async function</span>
            <span class="function">makePizza</span>() {<br />
            &nbsp;&nbsp;<span class="keyword">try</span> {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">const</span> i =
            <span class="keyword">await</span> buyIngredients();<br />
            &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">const</span> p =
            <span class="keyword">await</span> cutIngredients(i);<br />
            &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">const</span> f =
            <span class="keyword">await</span> cook(p);<br />
            &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">const</span> m =
            <span class="keyword">await</span> serve(f);<br />
            &nbsp;&nbsp;&nbsp;&nbsp;log(m);<br />
            &nbsp;&nbsp;} <span class="keyword">catch</span> (e) {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;error(e);<br />
            &nbsp;&nbsp;}<br />
            }
          </div>
          <button class="execute-button" id="asyncButton">
            async/await ã§å®Ÿè¡Œ
          </button>
          <div class="progress-bar">
            <div class="progress-fill" id="asyncProgress"></div>
          </div>
        </div>
      </div>

      <div class="control-buttons">
        <button class="reset-button" id="resetButton">ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢</button>
      </div>

      <div class="log-box" id="logBox"></div>

      <div class="advantages">
        <div class="advantage-card">
          <h4>âœ… èª­ã¿ã‚„ã™ã„</h4>
          <p>åŒæœŸå‡¦ç†ã¿ãŸã„ã«èª­ã‚ã‚‹ã‹ã‚‰ã€ç†è§£ã—ã‚„ã™ã„</p>
        </div>
        <div class="advantage-card">
          <h4>âœ… ãƒ‡ãƒãƒƒã‚°ã—ã‚„ã™ã„</h4>
          <p>ã‚¨ãƒ©ãƒ¼ã®å ´æ‰€ãŒç‰¹å®šã—ã‚„ã™ã„</p>
        </div>
        <div class="advantage-card">
          <h4>âœ… try-catch ãŒä½¿ãˆã‚‹</h4>
          <p>ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒç›´æ„Ÿçš„</p>
        </div>
        <div class="advantage-card">
          <h4>âœ… ã‚³ãƒ¼ãƒ‰ãŒçŸ­ã„</h4>
          <p>ãƒã‚¹ãƒˆãŒæµ…ãã¦ã‚¹ãƒƒã‚­ãƒª</p>
        </div>
      </div>

      <div class="info-box">
        <h3>ğŸ’¡ å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ</h3>
        <ul>
          <li>async/await ã¯ Promise ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«æ›¸ã‘ã‚‹æœ€æ–°ã®æ›¸ãæ–¹</li>
          <li>async ã‚’ä»˜ã‘ãŸé–¢æ•°ã¯è‡ªå‹•çš„ã« Promise ã‚’è¿”ã™</li>
          <li>await ã§ Promise ã®å®Œäº†ã‚’å¾…ã¤ï¼ˆåŒæœŸå‡¦ç†ã¿ãŸã„ã«è¦‹ãˆã‚‹ï¼‰</li>
          <li>try-catch ã§ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã§ãã‚‹</li>
          <li>ä¸¡æ–¹ã¨ã‚‚åŒã˜å‹•ä½œã‚’ã™ã‚‹ã‘ã©ã€async/await ã®æ–¹ãŒèª­ã¿ã‚„ã™ã„ï¼</li>
        </ul>
      </div>
    </div>

    <script>
      // ==========================================
      // è¦ç´ ã®å–å¾—
      // ==========================================
      const promiseButton = document.getElementById("promiseButton");
      const asyncButton = document.getElementById("asyncButton");
      const resetButton = document.getElementById("resetButton");
      const logBox = document.getElementById("logBox");
      const promiseProgress = document.getElementById("promiseProgress");
      const asyncProgress = document.getElementById("asyncProgress");

      // ==========================================
      // ãƒ­ã‚°å‡ºåŠ›é–¢æ•°
      // ==========================================
      function log(message, type = "info") {
        const logEntry = document.createElement("div");
        logEntry.className = `log-entry ${type}`;
        const timestamp = new Date().toLocaleTimeString("ja-JP");
        logEntry.textContent = `[${timestamp}] ${message}`;
        logBox.appendChild(logEntry);
        logBox.scrollTop = logBox.scrollHeight;
        console.log(message);
      }

      // ==========================================
      // Promise ã‚’è¿”ã™æ–™ç†é–¢æ•°ï¼ˆå†åˆ©ç”¨ï¼‰
      // ==========================================
      function buyIngredients() {
        return new Promise((resolve) => {
          setTimeout(() => {
            resolve("ãƒˆãƒãƒˆã€ãƒãƒ¼ã‚ºã€ç”Ÿåœ°");
          }, 1000);
        });
      }

      function cutIngredients(ingredients) {
        return new Promise((resolve) => {
          setTimeout(() => {
            resolve("åˆ‡ã£ãŸ" + ingredients);
          }, 1000);
        });
      }

      function cook(prepared) {
        return new Promise((resolve) => {
          setTimeout(() => {
            resolve("ç¾å‘³ã—ã„ãƒ”ã‚¶ğŸ•");
          }, 1000);
        });
      }

      function serve(food) {
        return new Promise((resolve) => {
          setTimeout(() => {
            resolve(`${food}ã‚’æä¾›ã—ã¾ã™`);
          }, 1000);
        });
      }

      // ==========================================
      // ã€æ–¹æ³•1ã€‘Promise ãƒã‚§ãƒ¼ãƒ³
      // ==========================================
      function makePizzaWithPromise() {
        log("========================================", "info");
        log("âš™ï¸ Promise ãƒã‚§ãƒ¼ãƒ³ã§æ–™ç†é–‹å§‹", "complete");
        log("========================================", "info");

        promiseButton.disabled = true;
        promiseProgress.style.width = "0%";

        buyIngredients()
          .then((ingredients) => {
            log(`âœ… ææ–™ã‚’è²·ã£ã¦ããŸ: ${ingredients}`, "success");
            promiseProgress.style.width = "25%";
            return cutIngredients(ingredients);
          })
          .then((prepared) => {
            log(`âœ… ææ–™ã‚’åˆ‡ã‚Šçµ‚ãˆãŸ`, "success");
            promiseProgress.style.width = "50%";
            return cook(prepared);
          })
          .then((food) => {
            log(`âœ… æ–™ç†ãŒã§ããŸ: ${food}`, "success");
            promiseProgress.style.width = "75%";
            return serve(food);
          })
          .then((message) => {
            log(`âœ… ${message}`, "success");
            promiseProgress.style.width = "100%";
            log("========================================", "complete");
            log("ğŸ‰ å®Œæˆï¼ã„ãŸã ãã¾ã™ï¼", "complete");
            log("========================================", "complete");
            promiseButton.disabled = false;
          })
          .catch((error) => {
            log(`âŒ ã‚¨ãƒ©ãƒ¼: ${error}`, "complete");
            promiseButton.disabled = false;
          });
      }

      // ==========================================
      // ã€æ–¹æ³•2ã€‘async/await
      // ==========================================
      async function makePizzaWithAsync() {
        log("========================================", "info");
        log("âœ¨ async/await ã§æ–™ç†é–‹å§‹", "complete");
        log("========================================", "info");

        asyncButton.disabled = true;
        asyncProgress.style.width = "0%";

        try {
          // await ã§å„å‡¦ç†ã®å®Œäº†ã‚’å¾…ã¤
          const ingredients = await buyIngredients();
          log(`âœ… ææ–™ã‚’è²·ã£ã¦ããŸ: ${ingredients}`, "success");
          asyncProgress.style.width = "25%";

          const prepared = await cutIngredients(ingredients);
          log(`âœ… ææ–™ã‚’åˆ‡ã‚Šçµ‚ãˆãŸ`, "success");
          asyncProgress.style.width = "50%";

          const food = await cook(prepared);
          log(`âœ… æ–™ç†ãŒã§ããŸ: ${food}`, "success");
          asyncProgress.style.width = "75%";

          const message = await serve(food);
          log(`âœ… ${message}`, "success");
          asyncProgress.style.width = "100%";

          log("========================================", "complete");
          log("ğŸ‰ å®Œæˆï¼ã„ãŸã ãã¾ã™ï¼", "complete");
          log("========================================", "complete");
        } catch (error) {
          log(`âŒ ã‚¨ãƒ©ãƒ¼: ${error}`, "complete");
        } finally {
          asyncButton.disabled = false;
        }
      }

      // ==========================================
      // ãƒªã‚»ãƒƒãƒˆé–¢æ•°
      // ==========================================
      function reset() {
        logBox.innerHTML = "";
        promiseProgress.style.width = "0%";
        asyncProgress.style.width = "0%";
        log("ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ", "info");
      }

      // ==========================================
      // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
      // ==========================================
      promiseButton.addEventListener("click", makePizzaWithPromise);
      asyncButton.addEventListener("click", makePizzaWithAsync);
      resetButton.addEventListener("click", reset);

      // ==========================================
      // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®ãƒ­ã‚°
      // ==========================================
      console.log("========================================");
      console.log("å•é¡Œ 3-5: async/await ã¸ã®å¤‰æ›");
      console.log("========================================");
      console.log("ã€å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆã€‘");
      console.log("1. async/await ã¯ Promise ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«æ›¸ã‘ã‚‹");
      console.log("2. async ã‚’ä»˜ã‘ãŸé–¢æ•°ã¯ Promise ã‚’è¿”ã™");
      console.log("3. await ã§ Promise ã®å®Œäº†ã‚’å¾…ã¤");
      console.log("4. try-catch ã§ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°");
      console.log("========================================");
      console.log("ã€Promise ãƒã‚§ãƒ¼ãƒ³ã¨async/awaitã®æ¯”è¼ƒã€‘");
      console.log("");
      console.log("// Promise ãƒã‚§ãƒ¼ãƒ³");
      console.log("getData()");
      console.log("  .then(data => processData(data))");
      console.log("  .then(result => console.log(result))");
      console.log("  .catch(error => console.error(error));");
      console.log("");
      console.log("// async/await");
      console.log("async function() {");
      console.log("  try {");
      console.log("    const data = await getData();");
      console.log("    const result = await processData(data);");
      console.log("    console.log(result);");
      console.log("  } catch (error) {");
      console.log("    console.error(error);");
      console.log("  }");
      console.log("}");
      console.log("========================================");
      console.log("ä¸¡æ–¹ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€å‹•ä½œã‚’æ¯”è¼ƒã—ã¦ã¿ã‚ˆã†ï¼");
      console.log("========================================");

      log("æº–å‚™å®Œäº†ï¼ä¸¡æ–¹ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ¯”è¼ƒã—ã¦ã¿ã¦ã­", "info");
    </script>
  </body>
</html>
