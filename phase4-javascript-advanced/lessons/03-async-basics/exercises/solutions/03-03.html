<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å•é¡Œ 3-3: Promise ã®åŸºæœ¬</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
      }

      .container {
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 600px;
        width: 100%;
        text-align: center;
      }

      h1 {
        color: #333;
        margin-bottom: 10px;
        font-size: 28px;
      }

      .subtitle {
        color: #666;
        margin-bottom: 30px;
        font-size: 14px;
      }

      .result-display {
        font-size: 24px;
        font-weight: bold;
        margin: 30px 0;
        min-height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #f8f9fa;
        border-radius: 15px;
        padding: 20px;
        border: 2px dashed #dee2e6;
      }

      .result-display.success {
        background: linear-gradient(135deg, #d4f7e8 0%, #c7f9e3 100%);
        border-color: #38ef7d;
        color: #11998e;
      }

      .result-display.error {
        background: linear-gradient(135deg, #ffe0e0 0%, #ffd0d0 100%);
        border-color: #ff6b6b;
        color: #c92a2a;
      }

      .result-display.pending {
        background: linear-gradient(135deg, #e0e7ff 0%, #d0dbff 100%);
        border-color: #667eea;
        color: #667eea;
      }

      .status-indicator {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 20px 0;
      }

      .status-item {
        padding: 10px 20px;
        border-radius: 20px;
        font-size: 14px;
        font-weight: bold;
        background: #f8f9fa;
        color: #adb5bd;
      }

      .status-item.active {
        animation: pulse 1s infinite;
      }

      .status-item.pending.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .status-item.fulfilled.active {
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        color: white;
      }

      .status-item.rejected.active {
        background: linear-gradient(135deg, #ff6b6b 0%, #c92a2a 100%);
        color: white;
      }

      button {
        padding: 15px 40px;
        font-size: 18px;
        font-weight: bold;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s;
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
        margin: 10px 0;
      }

      button:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(240, 147, 251, 0.4);
      }

      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none !important;
      }

      .info-box {
        background: #f8f9fa;
        border-left: 4px solid #f093fb;
        padding: 15px;
        margin-top: 30px;
        text-align: left;
        border-radius: 5px;
      }

      .info-box h3 {
        color: #f093fb;
        margin-bottom: 10px;
        font-size: 16px;
      }

      .info-box ul {
        margin-left: 20px;
        color: #666;
        font-size: 14px;
        line-height: 1.8;
      }

      .code-example {
        background: #2d3748;
        color: #f7fafc;
        padding: 15px;
        border-radius: 10px;
        margin-top: 20px;
        text-align: left;
        font-family: "Courier New", monospace;
        font-size: 12px;
        overflow-x: auto;
      }

      .code-example .keyword {
        color: #f093fb;
      }

      .code-example .function {
        color: #38ef7d;
      }

      .code-example .string {
        color: #ffd93d;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      @keyframes spinner {
        to {
          transform: rotate(360deg);
        }
      }

      .spinner {
        display: inline-block;
        width: 30px;
        height: 30px;
        border: 3px solid rgba(0, 0, 0, 0.1);
        border-radius: 50%;
        border-top-color: #667eea;
        animation: spinner 0.6s linear infinite;
      }

      .stats {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin: 20px 0;
      }

      .stat-card {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 10px;
      }

      .stat-label {
        font-size: 12px;
        color: #666;
        margin-bottom: 5px;
      }

      .stat-value {
        font-size: 24px;
        font-weight: bold;
        color: #f093fb;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ² Promise ã®åŸºæœ¬</h1>
      <p class="subtitle">å•é¡Œ 3-3: åŸºç¤ç·¨</p>

      <div class="status-indicator">
        <div class="status-item pending" id="pendingStatus">Pending</div>
        <div class="status-item fulfilled" id="fulfilledStatus">Fulfilled</div>
        <div class="status-item rejected" id="rejectedStatus">Rejected</div>
      </div>

      <div class="result-display" id="resultDisplay">
        çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™
      </div>

      <button id="executeButton">Promise ã‚’å®Ÿè¡Œ</button>

      <div class="stats">
        <div class="stat-card">
          <div class="stat-label">æˆåŠŸå›æ•°</div>
          <div class="stat-value" id="successCount">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">å¤±æ•—å›æ•°</div>
          <div class="stat-value" id="failCount">0</div>
        </div>
      </div>

      <div class="info-box">
        <h3>ğŸ’¡ å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ</h3>
        <ul>
          <li>Promise ã¯éåŒæœŸå‡¦ç†ã®æˆåŠŸ/å¤±æ•—ã‚’è¡¨ç¾ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</li>
          <li>resolve() ã§æˆåŠŸã€reject() ã§å¤±æ•—ã‚’é€šçŸ¥</li>
          <li>.then() ã§æˆåŠŸæ™‚ã®å‡¦ç†ã€.catch() ã§å¤±æ•—æ™‚ã®å‡¦ç†</li>
          <li>Promise ã®3ã¤ã®çŠ¶æ…‹: Pending â†’ Fulfilled ã¾ãŸã¯ Rejected</li>
        </ul>
      </div>

      <div class="code-example">
        <span class="keyword">const</span> promise =
        <span class="keyword">new</span>
        <span class="function">Promise</span>((resolve, reject) => {<br />
        &nbsp;&nbsp;<span class="keyword">if</span> (success) {<br />
        &nbsp;&nbsp;&nbsp;&nbsp;<span class="function">resolve</span>(<span
          class="string"
          >'æˆåŠŸï¼'</span
        >);<br />
        &nbsp;&nbsp;} <span class="keyword">else</span> {<br />
        &nbsp;&nbsp;&nbsp;&nbsp;<span class="function">reject</span>(<span
          class="string"
          >'å¤±æ•—...'</span
        >);<br />
        &nbsp;&nbsp;}<br />
        });<br /><br />
        promise<br />
        &nbsp;&nbsp;.<span class="function">then</span>((result) => { ... })<br />
        &nbsp;&nbsp;.<span class="function">catch</span>((error) => { ... });
      </div>
    </div>

    <script>
      // ==========================================
      // è¦ç´ ã®å–å¾—
      // ==========================================
      const executeButton = document.getElementById("executeButton");
      const resultDisplay = document.getElementById("resultDisplay");
      const pendingStatus = document.getElementById("pendingStatus");
      const fulfilledStatus = document.getElementById("fulfilledStatus");
      const rejectedStatus = document.getElementById("rejectedStatus");
      const successCountElement = document.getElementById("successCount");
      const failCountElement = document.getElementById("failCount");

      // çµ±è¨ˆæƒ…å ±
      let successCount = 0;
      let failCount = 0;

      // ==========================================
      // Promise ã‚’å®Ÿè¡Œã™ã‚‹ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
      // ==========================================
      executeButton.addEventListener("click", function () {
        console.log("========================================");
        console.log("Promise ã‚’å®Ÿè¡Œã—ã¾ã™");

        // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
        executeButton.disabled = true;

        // çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
        resetStatus();

        // Pending çŠ¶æ…‹ã‚’è¡¨ç¤º
        pendingStatus.classList.add("active");
        resultDisplay.className = "result-display pending";
        resultDisplay.innerHTML = '<div class="spinner"></div> å‡¦ç†ä¸­...';

        // Promise ã‚’ä½œæˆ
        const promise = new Promise(function (resolve, reject) {
          console.log("Promise ä½œæˆ: çŠ¶æ…‹ã¯ Pending");

          // 2ç§’å¾Œã«ãƒ©ãƒ³ãƒ€ãƒ ã§æˆåŠŸ/å¤±æ•—ã‚’æ±ºå®š
          setTimeout(function () {
            // Math.random() ã¯ 0ã€œ1 ã®ãƒ©ãƒ³ãƒ€ãƒ ãªæ•°ã‚’è¿”ã™
            // 0.5 ã‚ˆã‚Šå¤§ãã‘ã‚Œã°æˆåŠŸï¼ˆ50%ã®ç¢ºç‡ï¼‰
            const success = Math.random() > 0.5;

            console.log("ãƒ©ãƒ³ãƒ€ãƒ åˆ¤å®š:", success ? "æˆåŠŸ" : "å¤±æ•—");

            if (success) {
              // æˆåŠŸæ™‚: resolve ã‚’å‘¼ã¶
              console.log("resolve() ã‚’å‘¼ã³å‡ºã—ã¾ã™");
              resolve("æˆåŠŸã—ã¾ã—ãŸï¼ğŸ‰");
            } else {
              // å¤±æ•—æ™‚: reject ã‚’å‘¼ã¶
              console.log("reject() ã‚’å‘¼ã³å‡ºã—ã¾ã™");
              reject("å¤±æ•—ã—ã¾ã—ãŸğŸ˜¢");
            }
          }, 2000);
        });

        console.log("Promise ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ:", promise);
        console.log("2ç§’å¾Œã«æˆåŠŸ/å¤±æ•—ãŒæ±ºã¾ã‚Šã¾ã™");

        // Promise ã®çµæœã‚’å‡¦ç†
        promise
          .then(function (result) {
            // æˆåŠŸæ™‚ã®å‡¦ç†ï¼ˆresolve ãŒå‘¼ã°ã‚ŒãŸæ™‚ï¼‰
            console.log("========================================");
            console.log(".then() ãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸ");
            console.log("æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:", result);

            // Fulfilled çŠ¶æ…‹ã‚’è¡¨ç¤º
            pendingStatus.classList.remove("active");
            fulfilledStatus.classList.add("active");
            resultDisplay.className = "result-display success";
            resultDisplay.textContent = result;

            // çµ±è¨ˆã‚’æ›´æ–°
            successCount++;
            successCountElement.textContent = successCount;

            console.log("Promise ã®çŠ¶æ…‹: Fulfilled");
            console.log("========================================");

            // ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
            executeButton.disabled = false;
          })
          .catch(function (error) {
            // å¤±æ•—æ™‚ã®å‡¦ç†ï¼ˆreject ãŒå‘¼ã°ã‚ŒãŸæ™‚ï¼‰
            console.log("========================================");
            console.log(".catch() ãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸ");
            console.log("ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:", error);

            // Rejected çŠ¶æ…‹ã‚’è¡¨ç¤º
            pendingStatus.classList.remove("active");
            rejectedStatus.classList.add("active");
            resultDisplay.className = "result-display error";
            resultDisplay.textContent = error;

            // çµ±è¨ˆã‚’æ›´æ–°
            failCount++;
            failCountElement.textContent = failCount;

            console.log("Promise ã®çŠ¶æ…‹: Rejected");
            console.log("========================================");

            // ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
            executeButton.disabled = false;
          });

        console.log("========================================");
      });

      // ==========================================
      // çŠ¶æ…‹è¡¨ç¤ºã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹é–¢æ•°
      // ==========================================
      function resetStatus() {
        pendingStatus.classList.remove("active");
        fulfilledStatus.classList.remove("active");
        rejectedStatus.classList.remove("active");
      }

      // ==========================================
      // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®ãƒ­ã‚°
      // ==========================================
      console.log("========================================");
      console.log("å•é¡Œ 3-3: Promise ã®åŸºæœ¬");
      console.log("========================================");
      console.log("ã€å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆã€‘");
      console.log("1. Promise ã¯éåŒæœŸå‡¦ç†ã®æˆåŠŸ/å¤±æ•—ã‚’è¡¨ç¾ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ");
      console.log("2. resolve() ã§æˆåŠŸã€reject() ã§å¤±æ•—ã‚’é€šçŸ¥");
      console.log("3. .then() ã§æˆåŠŸæ™‚ã®å‡¦ç†ã€.catch() ã§å¤±æ•—æ™‚ã®å‡¦ç†");
      console.log("========================================");
      console.log("ã€Promise ã®3ã¤ã®çŠ¶æ…‹ã€‘");
      console.log("1. Pendingï¼ˆä¿ç•™ä¸­ï¼‰: å‡¦ç†ä¸­");
      console.log("2. Fulfilledï¼ˆæˆåŠŸï¼‰: resolve ãŒå‘¼ã°ã‚ŒãŸ");
      console.log("3. Rejectedï¼ˆå¤±æ•—ï¼‰: reject ãŒå‘¼ã°ã‚ŒãŸ");
      console.log("========================================");
      console.log("ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ Promise ã‚’å®Ÿè¡Œã—ã¦ã¿ã‚ˆã†ï¼");
      console.log("ä½•åº¦ã‹è©¦ã—ã¦ã€æˆåŠŸã¨å¤±æ•—ã®é•ã„ã‚’ç¢ºèªã—ã¦ã­ï¼");
      console.log("========================================");
    </script>
  </body>
</html>
