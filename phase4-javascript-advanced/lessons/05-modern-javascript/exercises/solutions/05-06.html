<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¼”ç¿’ 5-6: å¤ã„ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¢ãƒ€ãƒ³ã«</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #FF6B6B 0%, #FFE66D 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .container { max-width: 1400px; margin: 0 auto; }
    h1 {
      text-align: center;
      color: white;
      margin-bottom: 10px;
      font-size: 2.5em;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }
    .subtitle {
      text-align: center;
      color: rgba(255, 255, 255, 0.9);
      margin-bottom: 30px;
    }
    .comparison {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }
    .code-box {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }
    .code-box.old {
      border: 3px solid #FF6B6B;
    }
    .code-box.new {
      border: 3px solid #51CF66;
    }
    .code-box h2 {
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 3px solid;
    }
    .code-box.old h2 {
      color: #FF6B6B;
      border-color: #FF6B6B;
    }
    .code-box.new h2 {
      color: #51CF66;
      border-color: #51CF66;
    }
    .code-display {
      background: #2d3748;
      color: #68d391;
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
      font-family: 'Courier New', monospace;
      overflow-x: auto;
      white-space: pre;
      font-size: 0.9em;
      line-height: 1.5;
    }
    .stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin: 15px 0;
    }
    .stat {
      background: #f8f9fa;
      padding: 10px;
      border-radius: 8px;
      text-align: center;
    }
    .stat-value {
      font-size: 1.8em;
      font-weight: bold;
      margin: 5px 0;
    }
    .stat.old .stat-value { color: #FF6B6B; }
    .stat.new .stat-value { color: #51CF66; }
    .stat-label {
      font-size: 0.85em;
      color: #666;
    }
    button {
      background: linear-gradient(135deg, #FF6B6B 0%, #FFE66D 100%);
      color: white;
      border: none;
      padding: 15px 40px;
      font-size: 1.1em;
      border-radius: 25px;
      cursor: pointer;
      transition: transform 0.2s;
      box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
      display: block;
      margin: 20px auto;
    }
    button:hover { transform: translateY(-2px); }
    .improvement {
      background: #e6f7ff;
      border: 2px solid #1890ff;
      border-radius: 10px;
      padding: 15px;
      margin: 15px 0;
    }
    .improvement h3 {
      color: #1890ff;
      margin-bottom: 10px;
    }
    ul {
      margin-left: 20px;
      line-height: 1.8;
    }
    @media (max-width: 1000px) {
      .comparison { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”„ å¤ã„ã‚³ãƒ¼ãƒ‰ â†’ ãƒ¢ãƒ€ãƒ³ãªã‚³ãƒ¼ãƒ‰</h1>
    <p class="subtitle">ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®åŠ›ã‚’ä½“æ„Ÿã—ã‚ˆã†ï¼</p>

    <button onclick="runBothVersions()">âš¡ ä¸¡æ–¹ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦æ¯”è¼ƒ</button>

    <div class="comparison" id="codeComparison"></div>
    <div id="results"></div>
  </div>

  <script>
    // ãƒ‡ãƒ¼ã‚¿
    const users = [
      { name: 'å¤ªéƒ', age: 25, city: 'æ±äº¬' },
      { name: 'èŠ±å­', age: 30, city: 'å¤§é˜ª' },
      { name: 'æ¬¡éƒ', age: 28, city: 'ç¦å²¡' },
      { name: 'ä¸‰éƒ', age: 22, city: 'æ±äº¬' },
    ];

    // ğŸ”´ æ˜”ã®ã‚³ãƒ¼ãƒ‰ï¼ˆ2015å¹´ä»¥å‰ï¼‰
    function oldWay() {
      console.log('=== ğŸ”´ æ˜”ã®ã‚„ã‚Šæ–¹ ===');
      var startTime = Date.now();

      // 1. varã‚’ä½¿ã†
      var result = [];

      // 2. foræ–‡ã§ãƒ«ãƒ¼ãƒ—
      for (var i = 0; i < users.length; i++) {
        if (users[i].age >= 25) {
          result.push(users[i].name);
        }
      }
      console.log('25æ­³ä»¥ä¸Šã®åå‰:', result);

      // 3. æ–‡å­—åˆ—çµåˆ
      var message = 'çµæœ: ' + result.join(', ');
      console.log(message);

      // 4. Object.assign
      var defaultSettings = { theme: 'light', fontSize: 14 };
      var userSettings = { fontSize: 18 };
      var settings = Object.assign({}, defaultSettings, userSettings);
      console.log('è¨­å®š:', settings);

      // 5. é•·ã„nullãƒã‚§ãƒƒã‚¯
      function getCity(user) {
        if (user && user.profile && user.profile.address) {
          return user.profile.address.city;
        }
        return 'ä¸æ˜';
      }
      var testUser = { profile: { address: { city: 'æœ­å¹Œ' } } };
      console.log('éƒ½å¸‚:', getCity(testUser));

      // 6. é–¢æ•°å®šç¾©
      function displayUser(user) {
        var name = user.name;
        var age = user.age;
        var city = user.city;
        console.log('åå‰: ' + name + ', å¹´é½¢: ' + age + ', éƒ½å¸‚: ' + city);
      }
      displayUser(users[0]);

      var endTime = Date.now();
      var executionTime = endTime - startTime;

      return {
        result: result,
        message: message,
        settings: settings,
        city: getCity(testUser),
        executionTime: executionTime,
        codeLength: oldWay.toString().length,
        lines: oldWay.toString().split('\n').length
      };
    }

    // âœ… ãƒ¢ãƒ€ãƒ³ãªã‚³ãƒ¼ãƒ‰ï¼ˆES6ä»¥é™ï¼‰
    function modernWay() {
      console.log('=== âœ… ãƒ¢ãƒ€ãƒ³ãªã‚„ã‚Šæ–¹ ===');
      const startTime = Date.now();

      // 1. const/letã‚’ä½¿ã† & é…åˆ—ãƒ¡ã‚½ãƒƒãƒ‰
      const result = users
        .filter(user => user.age >= 25)
        .map(user => user.name);
      console.log('25æ­³ä»¥ä¸Šã®åå‰:', result);

      // 2. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªãƒ†ãƒ©ãƒ«
      const message = `çµæœ: ${result.join(', ')}`;
      console.log(message);

      // 3. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æ§‹æ–‡
      const defaultSettings = { theme: 'light', fontSize: 14 };
      const userSettings = { fontSize: 18 };
      const settings = { ...defaultSettings, ...userSettings };
      console.log('è¨­å®š:', settings);

      // 4. ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ãƒã‚§ã‚¤ãƒ‹ãƒ³ã‚° + Nullishåˆä½“
      const getCity = (user) => user?.profile?.address?.city ?? 'ä¸æ˜';
      const testUser = { profile: { address: { city: 'æœ­å¹Œ' } } };
      console.log('éƒ½å¸‚:', getCity(testUser));

      // 5. å¼•æ•°ã§åˆ†å‰²ä»£å…¥
      const displayUser = ({ name, age, city }) => {
        console.log(`åå‰: ${name}, å¹´é½¢: ${age}, éƒ½å¸‚: ${city}`);
      };
      displayUser(users[0]);

      const endTime = Date.now();
      const executionTime = endTime - startTime;

      return {
        result,
        message,
        settings,
        city: getCity(testUser),
        executionTime,
        codeLength: modernWay.toString().length,
        lines: modernWay.toString().split('\n').length
      };
    }

    function runBothVersions() {
      console.clear();

      // ä¸¡æ–¹å®Ÿè¡Œ
      const oldResult = oldWay();
      const modernResult = modernWay();

      // ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
      const oldCode = oldWay.toString();
      const modernCode = modernWay.toString();

      document.getElementById('codeComparison').innerHTML = `
        <div class="code-box old">
          <h2>ğŸ”´ æ˜”ã®æ›¸ãæ–¹ï¼ˆ2015å¹´ä»¥å‰ï¼‰</h2>
          <div class="stats">
            <div class="stat old">
              <div class="stat-value">${oldResult.lines}</div>
              <div class="stat-label">è¡Œæ•°</div>
            </div>
            <div class="stat old">
              <div class="stat-value">${oldResult.codeLength}</div>
              <div class="stat-label">æ–‡å­—æ•°</div>
            </div>
            <div class="stat old">
              <div class="stat-value">${oldResult.executionTime}ms</div>
              <div class="stat-label">å®Ÿè¡Œæ™‚é–“</div>
            </div>
          </div>
          <div class="code-display">${escapeHtml(oldCode)}</div>
          <ul style="color: #666; margin-top: 15px;">
            <li>var ã‚’ä½¿ç”¨</li>
            <li>for æ–‡ã§ãƒ«ãƒ¼ãƒ—</li>
            <li>æ–‡å­—åˆ—çµåˆï¼ˆ+ï¼‰</li>
            <li>Object.assign()</li>
            <li>é•·ã„ if æ–‡ã§nullãƒã‚§ãƒƒã‚¯</li>
            <li>function ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</li>
          </ul>
        </div>

        <div class="code-box new">
          <h2>âœ… ãƒ¢ãƒ€ãƒ³ãªæ›¸ãæ–¹ï¼ˆES6ä»¥é™ï¼‰</h2>
          <div class="stats">
            <div class="stat new">
              <div class="stat-value">${modernResult.lines}</div>
              <div class="stat-label">è¡Œæ•°</div>
            </div>
            <div class="stat new">
              <div class="stat-value">${modernResult.codeLength}</div>
              <div class="stat-label">æ–‡å­—æ•°</div>
            </div>
            <div class="stat new">
              <div class="stat-value">${modernResult.executionTime}ms</div>
              <div class="stat-label">å®Ÿè¡Œæ™‚é–“</div>
            </div>
          </div>
          <div class="code-display">${escapeHtml(modernCode)}</div>
          <ul style="color: #666; margin-top: 15px;">
            <li>const/let ã‚’ä½¿ç”¨</li>
            <li>é…åˆ—ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆfilterã€mapï¼‰</li>
            <li>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªãƒ†ãƒ©ãƒ«ï¼ˆ\`\${}\`ï¼‰</li>
            <li>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æ§‹æ–‡ï¼ˆ...ï¼‰</li>
            <li>ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ãƒã‚§ã‚¤ãƒ‹ãƒ³ã‚°ï¼ˆ?.ï¼‰</li>
            <li>ã‚¢ãƒ­ãƒ¼é–¢æ•°ï¼ˆ=>ï¼‰</li>
          </ul>
        </div>
      `;

      const reductionPercent = Math.round((1 - modernResult.lines / oldResult.lines) * 100);

      document.getElementById('results').innerHTML = `
        <div class="improvement">
          <h3>ğŸ“Š æ”¹å–„åŠ¹æœ</h3>
          <ul>
            <li><strong>è¡Œæ•°å‰Šæ¸›:</strong> ${oldResult.lines}è¡Œ â†’ ${modernResult.lines}è¡Œï¼ˆ${reductionPercent}%å‰Šæ¸›ï¼‰</li>
            <li><strong>èª­ã¿ã‚„ã™ã•:</strong> ãƒ¢ãƒ€ãƒ³ãªè¨˜æ³•ã®æ–¹ãŒæ„å›³ãŒæ˜ç¢º</li>
            <li><strong>ãƒã‚°ã®æ¸›å°‘:</strong> constã«ã‚ˆã‚‹ã‚¹ã‚³ãƒ¼ãƒ—ã®æ˜ç¢ºåŒ–ã€ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªæ›¸ãæ–¹</li>
            <li><strong>ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§:</strong> å¤‰æ›´ç®‡æ‰€ãŒåˆ†ã‹ã‚Šã‚„ã™ã„</li>
            <li><strong>AIã¨ã®å”åƒ:</strong> AIã¯ãƒ¢ãƒ€ãƒ³ãªè¨˜æ³•ã§ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ</li>
          </ul>
        </div>

        <div class="improvement" style="border-color: #52c41a; background: #f6ffed;">
          <h3>âœ… å®Ÿè¡Œçµæœï¼ˆä¸¡æ–¹ã¨ã‚‚åŒã˜ï¼‰</h3>
          <ul>
            <li>25æ­³ä»¥ä¸Šã®åå‰: ${JSON.stringify(modernResult.result)}</li>
            <li>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ${modernResult.message}</li>
            <li>è¨­å®š: ${JSON.stringify(modernResult.settings)}</li>
            <li>éƒ½å¸‚: ${modernResult.city}</li>
          </ul>
        </div>

        <div class="improvement" style="border-color: #fa8c16; background: #fff7e6;">
          <h3>ğŸ’¡ ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®ãƒã‚¤ãƒ³ãƒˆ</h3>
          <ul>
            <li><strong>var â†’ const/let:</strong> ã‚¹ã‚³ãƒ¼ãƒ—ã®å•é¡Œã‚’é˜²ã</li>
            <li><strong>for â†’ é…åˆ—ãƒ¡ã‚½ãƒƒãƒ‰:</strong> æ„å›³ãŒæ˜ç¢ºã€ãƒã‚°ãŒæ¸›ã‚‹</li>
            <li><strong>+ â†’ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªãƒ†ãƒ©ãƒ«:</strong> èª­ã¿ã‚„ã™ã„ã€æ”¹è¡Œã‚‚ç°¡å˜</li>
            <li><strong>Object.assign â†’ ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰:</strong> çŸ­ãã¦åˆ†ã‹ã‚Šã‚„ã™ã„</li>
            <li><strong>ifæ–‡ â†’ ?. ã¨ ??:</strong> åŠ‡çš„ã«çŸ­ããªã‚‹</li>
            <li><strong>function â†’ ã‚¢ãƒ­ãƒ¼é–¢æ•°:</strong> thisã®æŒ™å‹•ãŒå®‰å®š</li>
          </ul>
        </div>
      `;
    }

    function escapeHtml(text) {
      return text
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
    }

    console.log('ğŸ”„ ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®ç·´ç¿’ã¸ã‚ˆã†ã“ãï¼');
    console.log('ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€å¤ã„ã‚³ãƒ¼ãƒ‰ã¨ãƒ¢ãƒ€ãƒ³ãªã‚³ãƒ¼ãƒ‰ã‚’æ¯”è¼ƒã—ã¦ã¿ã‚ˆã†ï¼');
  </script>
</body>
</html>
