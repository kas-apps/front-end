<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¼”ç¿’ 5-5: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œ</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .container { max-width: 1200px; margin: 0 auto; }
    h1 {
      text-align: center;
      color: white;
      margin-bottom: 10px;
      font-size: 2.5em;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }
    .subtitle {
      text-align: center;
      color: rgba(255, 255, 255, 0.9);
      margin-bottom: 30px;
      font-size: 1.1em;
    }
    .demo-section {
      background: white;
      border-radius: 15px;
      padding: 30px;
      margin-bottom: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }
    .demo-section h2 {
      color: #667eea;
      margin-bottom: 20px;
      font-size: 1.8em;
      border-bottom: 3px solid #667eea;
      padding-bottom: 10px;
    }
    button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 12px 30px;
      font-size: 1em;
      border-radius: 25px;
      cursor: pointer;
      transition: transform 0.2s;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
      margin: 5px;
    }
    button:hover { transform: translateY(-2px); }
    .code-display {
      background: #2d3748;
      color: #68d391;
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
      font-family: 'Courier New', monospace;
      overflow-x: auto;
      white-space: pre-wrap;
    }
    .user-box {
      background: #f8f9fa;
      border: 2px solid #667eea;
      border-radius: 10px;
      padding: 20px;
      margin: 15px 0;
    }
    .user-box h3 { color: #667eea; margin-bottom: 10px; }
    .property { padding: 8px 0; border-bottom: 1px solid #e0e0e0; }
    .property:last-child { border-bottom: none; }
    .label { font-weight: bold; color: #666; display: inline-block; width: 150px; }
    .comparison { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
    .before { background: #fff1f0; border: 2px solid #ff4d4f; padding: 15px; border-radius: 8px; }
    .after { background: #f6ffed; border: 2px solid #52c41a; padding: 15px; border-radius: 8px; }
    input, select {
      width: 100%;
      padding: 10px;
      margin: 5px 0;
      border: 2px solid #d9d9d9;
      border-radius: 5px;
      font-size: 1em;
    }
    input:focus, select:focus {
      outline: none;
      border-color: #667eea;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”§ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œ</h1>
    <p class="subtitle">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æ§‹æ–‡ã¨åˆ†å‰²ä»£å…¥ã‚’çµ„ã¿åˆã‚ã›ã‚ˆã†ï¼</p>

    <div class="demo-section">
      <h2>1. ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®æ›´æ–°</h2>
      <button onclick="demoUpdate()">å®Ÿè¡Œ</button>
      <div id="updateResult"></div>
    </div>

    <div class="demo-section">
      <h2>2. ãƒã‚¹ãƒˆã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ›´æ–°</h2>
      <button onclick="demoNestedUpdate()">å®Ÿè¡Œ</button>
      <div id="nestedResult"></div>
    </div>

    <div class="demo-section">
      <h2>3. ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®é™¤å¤–</h2>
      <button onclick="demoExclude()">å®Ÿè¡Œ</button>
      <div id="excludeResult"></div>
    </div>

    <div class="demo-section">
      <h2>4. ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªæ›´æ–°ãƒ•ã‚©ãƒ¼ãƒ </h2>
      <div style="margin: 20px 0;">
        <input type="text" id="nameInput" placeholder="åå‰">
        <input type="number" id="ageInput" placeholder="å¹´é½¢">
        <input type="text" id="cityInput" placeholder="éƒ½å¸‚">
        <button onclick="updateUser()">âœï¸ æ›´æ–°</button>
        <button onclick="resetUser()">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
      </div>
      <div id="formResult"></div>
    </div>
  </div>

  <script>
    let currentUser = {
      id: 1,
      name: 'å¤ªéƒ',
      age: 25,
      email: 'taro@example.com',
      password: 'secret123',
      profile: {
        city: 'æ±äº¬',
        bio: 'ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã™',
        hobbies: ['èª­æ›¸', 'ã‚²ãƒ¼ãƒ ']
      }
    };

    function displayUser(user, title = 'ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±') {
      return `
        <div class="user-box">
          <h3>${title}</h3>
          ${Object.entries(user).map(([key, value]) => {
            const displayValue = typeof value === 'object' ? JSON.stringify(value, null, 2) : value;
            return `<div class="property"><span class="label">${key}:</span> ${displayValue}</div>`;
          }).join('')}
        </div>
      `;
    }

    function demoUpdate() {
      console.clear();
      console.log('=== ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®æ›´æ–° ===');

      const original = { ...currentUser };

      // å¹´é½¢ã ã‘æ›´æ–°
      const updated1 = { ...original, age: 26 };

      // è¤‡æ•°æ›´æ–°
      const updated2 = { ...original, age: 26, email: 'taro.new@example.com' };

      console.log('å…ƒ:', original);
      console.log('å¹´é½¢ã®ã¿æ›´æ–°:', updated1);
      console.log('è¤‡æ•°æ›´æ–°:', updated2);

      const code = `const user = { id: 1, name: 'å¤ªéƒ', age: 25, email: 'taro@example.com' };

// å¹´é½¢ã ã‘æ›´æ–°
const updated1 = { ...user, age: 26 };

// è¤‡æ•°ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æ›´æ–°
const updated2 = { ...user, age: 26, email: 'taro.new@example.com' };

// âœ… å…ƒã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯å¤‰æ›´ã•ã‚Œãªã„ï¼`;

      document.getElementById('updateResult').innerHTML = `
        <div class="code-display">${code}</div>
        <div class="comparison">
          <div class="before">
            <h4>ğŸ”´ å…ƒã®ãƒ¦ãƒ¼ã‚¶ãƒ¼</h4>
            ${displayUser({ id: original.id, name: original.name, age: original.age, email: original.email }, '')}
          </div>
          <div class="after">
            <h4>ğŸŸ¢ æ›´æ–°å¾Œ</h4>
            ${displayUser({ id: updated2.id, name: updated2.name, age: updated2.age, email: updated2.email }, '')}
          </div>
        </div>
        <p style="padding: 15px; background: #e6f7ff; border-radius: 8px; margin-top: 15px;">
          <strong>âœ… ãƒã‚¤ãƒ³ãƒˆ:</strong> å…ƒã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯å¤‰æ›´ã•ã‚Œãšã€æ–°ã—ã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä½œã‚‰ã‚Œã‚‹ï¼ˆã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ï¼‰
        </p>
      `;
    }

    function demoNestedUpdate() {
      console.clear();
      console.log('=== ãƒã‚¹ãƒˆã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ›´æ–° ===');

      const original = { ...currentUser, profile: { ...currentUser.profile } };

      // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã®éƒ½å¸‚ã ã‘æ›´æ–°
      const updated = {
        ...original,
        profile: {
          ...original.profile,
          city: 'å¤§é˜ª'
        }
      };

      console.log('å…ƒ:', original);
      console.log('éƒ½å¸‚æ›´æ–°å¾Œ:', updated);

      const code = `const user = {
  id: 1,
  name: 'å¤ªéƒ',
  profile: { city: 'æ±äº¬', bio: 'ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã™' }
};

// âŒ é–“é•ã„ï¼šprofileãŒä¸Šæ›¸ãã•ã‚Œã‚‹
const wrong = {
  ...user,
  profile: { city: 'å¤§é˜ª' }  // bioãŒæ¶ˆãˆã‚‹ï¼
};

// âœ… æ­£ã—ã„ï¼šprofileã‚‚ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰
const correct = {
  ...user,
  profile: {
    ...user.profile,  // æ—¢å­˜ã®profileã‚’ã‚³ãƒ”ãƒ¼
    city: 'å¤§é˜ª'      // cityã ã‘ä¸Šæ›¸ã
  }
};`;

      document.getElementById('nestedResult').innerHTML = `
        <div class="code-display">${code}</div>
        <div class="comparison">
          <div class="before">
            <h4>ğŸ”´ å…ƒã®ãƒ‡ãƒ¼ã‚¿</h4>
            <pre style="background: white; padding: 10px; border-radius: 5px;">${JSON.stringify(original, null, 2)}</pre>
          </div>
          <div class="after">
            <h4>ğŸŸ¢ éƒ½å¸‚ã‚’å¤§é˜ªã«æ›´æ–°</h4>
            <pre style="background: white; padding: 10px; border-radius: 5px;">${JSON.stringify(updated, null, 2)}</pre>
          </div>
        </div>
      `;
    }

    function demoExclude() {
      console.clear();
      console.log('=== ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®é™¤å¤– ===');

      const user = { ...currentUser };

      // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’é™¤å¤–
      const { password, ...userWithoutPassword } = user;

      // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¨IDã‚’é™¤å¤–
      const { password: pw, id, ...publicUser } = user;

      console.log('å…ƒ:', user);
      console.log('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰é™¤å¤–:', userWithoutPassword);
      console.log('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰&IDé™¤å¤–:', publicUser);

      const code = `const user = {
  id: 1,
  name: 'å¤ªéƒ',
  email: 'taro@example.com',
  password: 'secret123'
};

// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’é™¤å¤–
const { password, ...userWithoutPassword } = user;
// â†’ { id, name, email }

// è¤‡æ•°ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’é™¤å¤–
const { password: pw, id, ...publicUser } = user;
// â†’ { name, email }`;

      document.getElementById('excludeResult').innerHTML = `
        <div class="code-display">${code}</div>
        ${displayUser(user, 'ğŸ”´ å…ƒã®ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å«ã‚€ï¼‰')}
        ${displayUser(userWithoutPassword, 'ğŸŸ¢ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰é™¤å¤–')}
        ${displayUser(publicUser, 'ğŸŸ¢ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰&IDé™¤å¤–ï¼ˆå…¬é–‹ç”¨ï¼‰')}
        <p style="padding: 15px; background: #fff7e6; border-left: 4px solid #fa8c16; border-radius: 8px; margin-top: 15px;">
          <strong>ğŸ¯ ä½¿ã„ã©ã“ã‚:</strong> APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã©ã®æ©Ÿå¯†æƒ…å ±ã‚’é™¤å¤–ã—ã¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”ã™
        </p>
      `;
    }

    function updateUser() {
      const name = document.getElementById('nameInput').value;
      const age = parseInt(document.getElementById('ageInput').value);
      const city = document.getElementById('cityInput').value;

      const original = { ...currentUser };

      // ç©ºã§ãªã„å€¤ã ã‘ã§æ›´æ–°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
      const updates = {};
      if (name) updates.name = name;
      if (age) updates.age = age;
      if (city) {
        updates.profile = {
          ...currentUser.profile,
          city: city
        };
      }

      // æ›´æ–°ã‚’é©ç”¨
      currentUser = { ...currentUser, ...updates };

      console.log('æ›´æ–°:', updates);
      console.log('æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼:', currentUser);

      document.getElementById('formResult').innerHTML = `
        <div class="comparison">
          <div class="before">
            <h4>ğŸ”´ æ›´æ–°å‰</h4>
            <pre style="background: white; padding: 10px; border-radius: 5px;">${JSON.stringify(original, null, 2)}</pre>
          </div>
          <div class="after">
            <h4>ğŸŸ¢ æ›´æ–°å¾Œ</h4>
            <pre style="background: white; padding: 10px; border-radius: 5px;">${JSON.stringify(currentUser, null, 2)}</pre>
          </div>
        </div>
      `;
    }

    function resetUser() {
      currentUser = {
        id: 1,
        name: 'å¤ªéƒ',
        age: 25,
        email: 'taro@example.com',
        password: 'secret123',
        profile: {
          city: 'æ±äº¬',
          bio: 'ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã™',
          hobbies: ['èª­æ›¸', 'ã‚²ãƒ¼ãƒ ']
        }
      };
      document.getElementById('formResult').innerHTML = '<p style="color: #52c41a; font-weight: bold;">âœ… ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ</p>';
      document.getElementById('nameInput').value = '';
      document.getElementById('ageInput').value = '';
      document.getElementById('cityInput').value = '';
    }

    console.log('ğŸ”§ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œã®ç·´ç¿’ã¸ã‚ˆã†ã“ãï¼');
  </script>
</body>
</html>
